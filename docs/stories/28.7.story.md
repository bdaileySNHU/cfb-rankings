# Story 28.7: Archive Obsolete Scripts and Finalize Documentation

**Status:** ðŸ“‹ To Do
**Epic:** EPIC-028 Comprehensive Codebase Cleanup
**Priority:** Medium
**Risk Level:** ðŸŸ¡ Medium Risk
**Estimated Effort:** 4-5 hours

---

## Story

As a **developer or operator maintaining the Stat-urday Synthesis codebase**, I want **obsolete one-off fix scripts archived with clear documentation, and all project documentation updated to reflect the new clean structure**, so that **the codebase contains only actively-used code, and documentation accurately guides developers**.

---

## Acceptance Criteria

1. **archive/ directory created** with README.md explaining:
   - Purpose: Historical one-off scripts kept for reference only
   - **Do not run these scripts** - they were created for specific past issues
   - List of archived scripts with dates and original purposes

2. **Obsolete scripts identified and moved** to archive/:
   - fix_*.py files (fix_2025_records.py, fix_playoff_weeks.py, fix_championship_week_rankings.py, etc.)
   - One-off historical scripts (count_team_games.py, find_championship_teams.py, etc.)
   - Use `git mv` to preserve history
   - Estimated 15-20 files

3. **utilities/ directory created** for reusable helper scripts:
   - seed_data.py (moved from root)
   - demo.py (moved from root)
   - compare_rankings.py (moved from root)
   - compare_transfer_rankings.py (moved from root)
   - evaluate_rating_systems.py (moved from root)

4. **Root directory cleaned** - only essential files remain:
   - import_real_data.py (main data import entry point)
   - gunicorn_config.py (deployment requirement)
   - requirements.txt, requirements-dev.txt
   - pytest.ini, .env, .gitignore
   - README.md, CONTRIBUTING.md, DEVELOPMENT.md

5. **All documentation updated** to reflect final structure:
   - README.md: Update "Project Structure" section with new directories
   - DEVELOPMENT.md: Update all file path references
   - architecture.md: Update "Source Tree and Module Organization" section
   - CONTRIBUTING.md: Update development workflow with new paths

6. **Black formatting applied** to all Python files (now that reorganization is complete):
   - Run `black .` on entire codebase
   - Commit formatting changes separately from functional changes

7. **Flake8 linting report generated** and major issues documented:
   - Run `flake8 .` and capture output
   - Document known linting issues in DEVELOPMENT.md "Technical Debt" section
   - Fix critical issues (syntax errors, undefined names) if any found

---

## Integration Verification

- **IV1: Final Test Suite Pass** - Run all 124 tests - ALL must pass after all reorganization complete
- **IV2: Full Application Workflow Test** - Complete end-to-end workflow:
  - Start backend server
  - Load frontend in browser
  - Navigate all pages (rankings, teams, games, team detail, predictions, comparison)
  - Verify all features work identically to pre-cleanup state
- **IV3: Documentation Accuracy** - Manually verify 5 file paths referenced in documentation actually exist at specified locations
- **IV4: Clean Root Directory** - Verify root directory contains <15 files (down from 54)

---

## Dev Notes

### Previous Story Insights

**Story 28.6 Completed:**
- Core application code reorganized into src/ structure
- All imports updated comprehensively
- All 124 tests passing
- Application fully functional

**Dependency:**
- This is the final cleanup story
- Completes the epic by archiving obsolete code and finalizing documentation

[Source: `docs/stories/28.6.story.md`]

### File Locations

**Obsolete Scripts to Archive (15-20 files):**
```
fix_*.py files:
- fix_2025_records.py
- fix_playoff_weeks.py
- fix_championship_week_rankings.py
- add_postseason_column.py

One-off scripts:
- count_team_games.py
- find_championship_teams.py
- check_postseason_column.py
- recalculate_2024_rankings.py
- recalculate_2025_rankings.py
- save_championship_week_rankings.py
- save_historical_rankings.py
- verify_championship_processing.py
... (and more)
```

**Utilities to Move (5 files):**
```
- seed_data.py (development data generator)
- demo.py (standalone ELO demo)
- compare_rankings.py (ELO vs AP Poll comparison)
- compare_transfer_rankings.py (transfer portal comparison)
- evaluate_rating_systems.py (rating system evaluation)
- cfb_elo_ranking.py (standalone ELO implementation, if not moved in 28.6)
```

**Root Directory Target State (<15 files):**
```
/
â”œâ”€â”€ src/                      # Core application (Story 28.6)
â”œâ”€â”€ migrations/               # Database migrations (Story 28.5)
â”œâ”€â”€ diagnostics/              # Diagnostic scripts (Story 28.5)
â”œâ”€â”€ utilities/                # Reusable helpers (Story 28.7)
â”œâ”€â”€ archive/                  # Obsolete scripts (Story 28.7)
â”œâ”€â”€ scripts/                  # Production scripts (unchanged)
â”œâ”€â”€ tests/                    # Test suite (unchanged)
â”œâ”€â”€ frontend/                 # Frontend files (unchanged)
â”œâ”€â”€ deploy/                   # Deployment config (unchanged)
â”œâ”€â”€ docs/                     # Documentation (updated)
â”‚
â”œâ”€â”€ import_real_data.py       # Main data import
â”œâ”€â”€ gunicorn_config.py        # Deployment config
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ requirements-dev.txt
â”œâ”€â”€ pyproject.toml            # Black/isort config (Story 28.2)
â”œâ”€â”€ .flake8                   # Flake8 config (Story 28.2)
â”œâ”€â”€ pytest.ini
â”œâ”€â”€ .env (gitignored)
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ CONTRIBUTING.md (Story 28.1)
â”œâ”€â”€ DEVELOPMENT.md (Story 28.1)
```

[Source: `docs/prd.md#Code Organization`]

### Archive README Content

**archive/README.md should explain:**
```markdown
# Archive Directory

## âš ï¸ WARNING: Historical Scripts Only

**DO NOT RUN THESE SCRIPTS** unless you fully understand their purpose and the specific issue they were created to address.

## Purpose

This directory contains one-off scripts that were created to fix specific issues or perform one-time data manipulations. They are kept for historical reference and to preserve the git history of the project.

## When Were These Created?

These scripts were created during the organic growth of the project (26 epics over several months) to address specific issues that arose. They served their purpose and are no longer needed for regular operations.

## Script Categories

### Fix Scripts (fix_*.py)
One-time fixes for specific data issues.

### Recalculation Scripts (recalculate_*.py)
One-time recalculations of rankings or data.

### Historical Data Scripts
One-time scripts for populating or correcting historical data.

## If You Need to Run a Script

1. **Read the script carefully** - Understand what it does
2. **Check git history** - `git log --follow archive/script_name.py` to see why it was created
3. **Check if still relevant** - The issue may be long resolved
4. **Backup your database** - Before running any script that modifies data
5. **Test in development** - Never run directly in production

## Regular Operations

For regular operations, use:
- **Production scripts**: `scripts/` directory (weekly_update.py, etc.)
- **Data import**: `import_real_data.py` in root
- **Diagnostics**: `diagnostics/` directory
- **Utilities**: `utilities/` directory
```

[Source: Best practices for archiving code]

### Technical Constraints

- **Archive, don't delete** - Keep files for historical reference
- **Git mv for history** - Preserve file history when moving
- **Black formatting** - Apply after all file moves complete
- **Flake8 reporting only** - Document issues, don't necessarily fix all
- **Documentation completeness** - All docs must reflect final state

[Source: `docs/prd.md#Technical Constraints`]

### Testing Requirements

**File Organization Validation:**
```bash
# Count files in root (should be <15)
ls -1 *.py *.txt *.ini *.toml *.md | wc -l

# Verify archive/ contents
ls archive/*.py | wc -l  # Should be 15-20

# Verify utilities/ contents
ls utilities/*.py | wc -l  # Should be 5+
```

**Black Formatting:**
```bash
# Apply black to entire codebase
black .

# Verify formatting
black --check .
```

**Flake8 Linting:**
```bash
# Generate linting report
flake8 . | tee flake8-final-report.txt

# Count violations
flake8 . | wc -l

# Document in DEVELOPMENT.md
```

**Comprehensive End-to-End Test:**
```bash
# 1. Run full test suite
pytest -v

# 2. Start backend
python -m src.api.main  # or gunicorn

# 3. Test all API endpoints
curl http://localhost:8000/api/rankings
curl http://localhost:8000/api/teams
curl http://localhost:8000/api/games
curl http://localhost:8000/api/predictions
curl http://localhost:8000/api/admin/api-usage

# 4. Test frontend (manual in browser)
open http://localhost:8000/frontend/
```

[Source: `docs/EPIC-028-CODEBASE-CLEANUP.md#Story 28.7`]

---

## Tasks / Subtasks

1. **Create archive/ Directory** (20 minutes)
   - Create archive/ directory
   - Create comprehensive archive/README.md with warnings
   - Document purpose and usage guidelines
   - (AC: 1)

2. **Move Obsolete Fix Scripts** (30 minutes)
   - Identify all fix_*.py scripts in root
   - Use `git mv` to move to archive/
   - Document each script's original purpose in archive/README.md
   - (AC: 2)

3. **Move Obsolete One-Off Scripts** (30 minutes)
   - Identify one-off scripts (count_*, find_*, verify_*, save_*, etc.)
   - Use `git mv` to move to archive/
   - Document in archive/README.md
   - (AC: 2)

4. **Create utilities/ Directory** (20 minutes)
   - Create utilities/ directory
   - Create utilities/README.md explaining reusable helpers
   - Document purpose and usage
   - (AC: 3)

5. **Move Reusable Helper Scripts** (30 minutes)
   - Use `git mv` for seed_data.py, demo.py, compare_*.py, evaluate_*.py
   - Update imports in these scripts if needed
   - Test one script: `python utilities/seed_data.py --help`
   - (AC: 3)

6. **Verify Root Directory Cleanup** (10 minutes)
   - Count files in root: `ls -1 *.py *.txt *.md | wc -l`
   - Verify <15 files remain
   - Document final count
   - (AC: 4, IV4)

7. **Update README.md** (30 minutes)
   - Rewrite "Project Structure" section with final directory tree
   - Update all file path references
   - Add links to new directories
   - (AC: 5)

8. **Update DEVELOPMENT.md** (30 minutes)
   - Update all file path references to use new structure
   - Update "Core Module Responsibilities" with src/ paths
   - Update common development tasks with new paths
   - (AC: 5)

9. **Update architecture.md** (30 minutes)
   - Update "Source Tree and Module Organization" section
   - Replace old structure with new src/ structure
   - Update file path references throughout
   - (AC: 5)

10. **Update CONTRIBUTING.md** (15 minutes)
    - Update development workflow with new file paths
    - Update examples with src/ imports
    - Verify all references are current
    - (AC: 5)

11. **Apply Black Formatting** (20 minutes)
    - Run `black .` on entire codebase
    - Review changes: `git diff --stat`
    - Commit separately: "Apply black formatting to entire codebase"
    - (AC: 6)

12. **Generate Flake8 Report** (20 minutes)
    - Run `flake8 . | tee flake8-final-report.txt`
    - Review critical issues (syntax errors, undefined names)
    - Fix critical issues if found
    - Document known issues in DEVELOPMENT.md "Technical Debt" section
    - (AC: 7)

13. **Run Final Test Suite** (30 minutes)
    - Run `pytest -v` - ALL 124 tests MUST pass
    - Fix any failures discovered
    - Re-run until all pass
    - (IV1)

14. **Complete End-to-End Application Test** (40 minutes)
    - Start backend: `python -m src.api.main` or gunicorn
    - Test API endpoints (rankings, teams, games, predictions, admin)
    - Load frontend in browser: http://localhost:8000/frontend/
    - Navigate all pages: rankings, teams, games, team detail, predictions, comparison
    - Verify all features work identically to pre-cleanup
    - Check browser console for errors
    - (IV2)

15. **Verify Documentation Accuracy** (20 minutes)
    - Pick 5 file paths from updated documentation
    - Manually verify each file exists at specified location
    - Fix any incorrect paths
    - (IV3)

16. **Final Review and Commit** (20 minutes)
    - Review comprehensive git diff
    - Verify root directory <15 files
    - Verify all tests pass
    - Verify application works end-to-end
    - Commit with message: "Archive obsolete scripts and finalize documentation (Story 28.7)"
    - (AC: 1-7, IV1-IV4)

---

## Definition of Done

- [ ] archive/ directory created with comprehensive README.md
- [ ] All obsolete scripts moved to archive/ (15-20 files)
- [ ] utilities/ directory created with README.md
- [ ] All reusable helpers moved to utilities/ (5+ files)
- [ ] Root directory cleaned (<15 files)
- [ ] README.md updated with final project structure
- [ ] DEVELOPMENT.md updated with new file paths
- [ ] architecture.md updated with new structure
- [ ] CONTRIBUTING.md updated with new paths
- [ ] Black formatting applied to entire codebase
- [ ] Flake8 report generated and documented
- [ ] Full test suite passes (ALL 124 tests)
- [ ] Complete end-to-end application test passed
- [ ] Documentation paths verified accurate
- [ ] Root directory verified <15 files
- [ ] All acceptance criteria met (AC 1-7)
- [ ] All integration verifications pass (IV1-IV4)
- [ ] Changes committed with proper message

---

## Rollback Plan

**Risk Level:** ðŸŸ¡ Medium Risk (final consolidation)

**Rollback Steps:**
1. `git revert <black-commit>` - Remove formatting changes
2. `git revert <story-commit>` - Restore file locations and documentation
3. Run test suite: `pytest -v` (verify all tests pass)
4. Start backend and test manually

**Rollback Impact:** Medium - This story completes the epic, so rollback returns to pre-cleanup state for this phase only (Stories 28.1-28.6 would remain)

**Note:** Because Stories 28.1-28.6 are already committed, full rollback would require reverting the entire epic sequence

---

## Notes

- **Final story in epic** - Completes the comprehensive cleanup
- **Celebrate success** - From 54 files to <15 files in root directory
- **Black formatting last** - Apply after all file moves to avoid merge conflicts
- **Flake8 for awareness** - Document issues, don't necessarily fix everything
- **Comprehensive testing critical** - This is final validation before epic completion
- **Documentation completeness** - All docs must reflect final structure accurately
- **Epic completion criteria** - When this story is done, entire epic is complete

---

## Epic Completion

When this story is complete, verify all epic completion criteria:

âœ… All 7 stories completed with acceptance criteria met
âœ… Full test suite (124 tests) passes with 100% success rate
âœ… Root directory reduced from 54 files to <15 files
âœ… All core modules have comprehensive docstrings (Google style)
âœ… Coding standards documented and tooling configured
âœ… Developer onboarding documentation created (CONTRIBUTING.md, DEVELOPMENT.md)
âœ… File organization follows modern Python structure (src/, migrations/, diagnostics/, utilities/, archive/)
âœ… All documentation updated to reflect new structure
âœ… Zero regression in existing functionality
âœ… Production deployment tested and verified (if applicable)

---

**Related Documents:**
- Epic: `docs/EPIC-028-CODEBASE-CLEANUP.md`
- PRD: `docs/prd.md`
- Previous Story: `docs/stories/28.6.story.md`
- All Previous Stories: 28.1 through 28.6
