# Story 20.1: Reposition Predictions Below Rankings - Brownfield Addition

**Epic:** EPIC-020 - Reorder Game Predictions by Ranking
**Story:** 20.1
**Estimated Effort:** 1-2 hours

---

## User Story

As a **college football fan visiting the rankings page**,
I want **predictions to appear below the rankings table**,
So that **I understand the current rankings context before seeing predictions for upcoming games**.

---

## Story Context

### Existing System Integration

- **Integrates with:** `frontend/index.html` main page layout
- **Technology:** HTML5, CSS3, responsive grid layout
- **Follows pattern:** Card-based content organization (stats, rankings, predictions, legend)
- **Touch points:**
  - HTML structure in `frontend/index.html`
  - CSS classes for cards and spacing in `frontend/css/style.css`
  - JavaScript event listeners in `frontend/js/app.js` (ensure they still work)

### Current State

**Current Layout Order:**
1. Stats grid (Current Week, Total Teams, etc.)
2. Prediction Accuracy Banner
3. **Predictions Card** (lines 61-110 in index.html)
4. **Rankings Card** (lines 112-167 in index.html)
5. Legend

**Desired Layout Order:**
1. Stats grid
2. Prediction Accuracy Banner
3. **Rankings Card** ← Move up
4. **Predictions Card** ← Move down
5. Legend

---

## Acceptance Criteria

### Functional Requirements

1. **Predictions card appears below rankings card** on the main page
2. **Page maintains proper visual hierarchy** with appropriate spacing between cards
3. **Mobile responsive layout** continues to work correctly (cards stack properly on small screens)
4. **All JavaScript functionality** continues to work (predictions refresh, week selector, etc.)

### Integration Requirements

5. **Existing prediction filters** (Next Week button, Week selector, Refresh) continue to work unchanged
6. **Rankings table** display and limit selector continue to work unchanged
7. **CSS card styling** maintains consistent spacing and appearance
8. **JavaScript element references** by ID continue to work (no broken event listeners)

### Quality Requirements

9. **Visual regression testing** - No layout breaks on desktop, tablet, mobile
10. **Cross-browser testing** - Works in Chrome, Firefox, Safari, Edge
11. **No console errors** after reordering

---

## Technical Implementation

### Changes Required

**File:** `frontend/index.html`

**Step 1: Identify the sections to move**
- Predictions Card: Lines 61-110 (entire `<div class="card">` with predictions)
- Rankings Card: Lines 112-167 (entire `<div class="card">` with rankings)

**Step 2: Cut and paste HTML**
```html
<!-- Current order -->
<div id="accuracy-banner">...</div>
<!-- PREDICTIONS CARD (61-110) -->
<!-- RANKINGS CARD (112-167) -->
<div class="card"><!-- Legend --></div>

<!-- New order -->
<div id="accuracy-banner">...</div>
<!-- RANKINGS CARD (moved up) -->
<!-- PREDICTIONS CARD (moved down) -->
<div class="card"><!-- Legend --></div>
```

**Step 3: Verify element IDs remain unchanged**
- `#predictions-container`
- `#predictions-loading`
- `#predictions-error`
- `#rankings-container`
- `#loading`
- `#error`

These IDs must remain for JavaScript to work.

### Testing Checklist

**Visual Testing:**
- [ ] Desktop (1920x1080): Cards display properly
- [ ] Tablet (768x1024): Cards stack or display side-by-side as designed
- [ ] Mobile (375x667): Cards stack vertically with proper spacing
- [ ] Check spacing between accuracy banner → rankings → predictions → legend

**Functional Testing:**
- [ ] Click "Next Week" button - predictions load
- [ ] Select week from dropdown - predictions filter correctly
- [ ] Click "Refresh" button - predictions refresh
- [ ] Change rankings limit (Top 10, Top 25, etc.) - rankings update
- [ ] Page loads without console errors

**Cross-browser Testing:**
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge (optional)

---

## Technical Notes

### Integration Approach
- Pure HTML structural change - no logic modifications
- Maintain all existing element IDs and classes
- CSS already handles card spacing via `.card` class margins

### Existing Pattern Reference
- Follow existing card pattern: `<div class="card">` with `<div class="card-header">` and content
- Cards already have proper margins defined in `frontend/css/style.css`

### Key Constraints
- **Do not change element IDs** - JavaScript references them
- **Do not change class names** - CSS styles them
- **Maintain card structure** - header, content, same nesting

### Rollback Plan
If issues arise:
1. Cut predictions card
2. Paste it back above rankings card (original position)
3. Verify page works again

---

## Definition of Done

- [x] Functional requirements met
  - [ ] Predictions appear below rankings
  - [ ] Visual spacing is appropriate
  - [ ] Mobile responsive layout works
  - [ ] All JavaScript functionality works
- [x] Integration requirements verified
  - [ ] Prediction filters work unchanged
  - [ ] Rankings display works unchanged
  - [ ] CSS styling maintained
  - [ ] No broken JavaScript references
- [x] Existing functionality regression tested
  - [ ] Week selector works
  - [ ] Refresh button works
  - [ ] Limit selector works
  - [ ] Page loads without errors
- [x] Code follows existing patterns and standards
  - [ ] HTML structure unchanged (just reordered)
  - [ ] No new CSS needed
  - [ ] No JavaScript changes needed
- [x] Tests pass (existing and new)
  - [ ] Visual testing on 3 screen sizes
  - [ ] Functional testing of all buttons
  - [ ] Cross-browser testing
- [x] Documentation updated if applicable
  - [ ] Update EPIC-020 with completion notes

---

## Risk and Compatibility Check

### Minimal Risk Assessment

**Primary Risk:** JavaScript event listeners break if element IDs change or if DOM structure changes break event bubbling

**Mitigation:**
- Keep all element IDs unchanged
- Maintain exact card structure
- Test all interactive elements immediately after change

**Rollback:** Simply move predictions card back above rankings card (revert HTML order)

### Compatibility Verification

- [x] No breaking changes to existing APIs (no API changes)
- [x] Database changes (if any) are additive only (no database changes)
- [x] UI changes follow existing design patterns (pure reordering)
- [x] Performance impact is negligible (no performance change)

---

## Validation Checklist

### Scope Validation

- [x] Story can be completed in one development session (1-2 hours)
- [x] Integration approach is straightforward (HTML reordering)
- [x] Follows existing patterns exactly (maintains card structure)
- [x] No design or architecture work required

### Clarity Check

- [x] Story requirements are unambiguous (clear HTML reordering)
- [x] Integration points are clearly specified (index.html structure)
- [x] Success criteria are testable (visual and functional checks)
- [x] Rollback approach is simple (revert HTML order)

---

## Implementation Notes for Developer

1. **Open** `frontend/index.html`
2. **Locate** predictions card (lines ~61-110)
3. **Cut** entire predictions card div
4. **Locate** rankings card end (line ~167)
5. **Paste** predictions card after rankings card
6. **Save** file
7. **Test** locally:
   - Open page in browser
   - Check layout on desktop/tablet/mobile
   - Test all prediction buttons
   - Test all ranking selectors
   - Check browser console for errors
8. **Commit** with clear message about HTML reordering

**Estimated Time:** 30 minutes for change + 30-60 minutes for testing = 1-2 hours total
